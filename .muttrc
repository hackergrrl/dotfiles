# Basics {{{
set realname="Stephen Whitmore"
set from=stephen.whitmore@gmail.com

set editor="vim"

set charset = "UTF-8"
set locale = "en_US.UTF-8"
set ascii_chars

# Ask before quitting, but default to yes
set quit=ask-yes
# }}}

# PGP {{{
# source ~/.mutt/gpg2.rc
# source ~/.mutt/gpg.rc
# }}}

# Mailbox config {{{
set mbox_type=Maildir
set folder=$HOME/Mail
set spoolfile=$HOME/Mail/GMail/INBOX
# }}}

# Various {{{
#
set header_cache="~/.mutt/cache/headers"
set message_cachedir="~/.mutt/cache/bodies"
set certificate_file=~/.mutt/certificates
set mailcap_path=~/.mutt/mailcap
set record = "~/Mail/GMail/Sent"
set postponed = "~/Mail/GMail/Drafts"

unset mark_old  # Read/unread is good enough, thanks
# }}}

# Folder hooks {{{
#
## show only unread by default
folder-hook * push "<limit>~U<enter>"
# }}}

# Sidebar {{{
set sidebar_delim = ' | '
set sidebar_visible = yes
set sidebar_width = 35
color sidebar_new brightyellow default
bind index,pager <down>   sidebar-next
bind index,pager <up>   sidebar-prev
bind index,pager <right>   sidebar-open
# }}}

# Index {{{
set date_format = "%m/%d  %H:%M"
set index_format = "[%Z]  %D  %-25.20F  %s"
# }}}

# Mailboxes {{{
mailboxes =GMail/INBOX \
          =IPFS/INBOX \
          =GMail/Reading\ List \
          =GMail/SudoRoom \
          =GMail/NodeSchool \
          =GMail/Sent \
          =GMail/Drafts \
          =eight45/INBOX \
          =eight45/Sent

## hotkeys
macro index gi "<change-folder> =GMail/INBOX<enter>" "Go to Inbox"
macro index gd "<change-folder> =GMail/Drafts<enter>" "Go to Drafts"
macro index gs "<change-folder> =GMail/Sent<enter>" "Go to Sent"

macro index sm ":set sendmail="/usr/bin/msmtp"<enter>" "Send mail with SMTP"

macro index U "l ~U<enter>"
macro index A "l all<enter>"
#}}}

# Sending mail {{{
set fast_reply
set sendmail_wait = 0 # wait for sending to successfully finish, because email is important

set sendmail = "/usr/bin/msmtp"
# }}}

# Viewing mail {{{
alternative_order text/plain text/html
auto_view text/html
# }}}

# Key bindings {{{

# unbind problematic keys
bind index,pager \# noop
bind index i        noop
bind index w        noop
bind index p        noop

# basic bindings
bind pager i        exit
bind pager /        search
bind pager k        previous-line
bind pager j        next-line
bind pager gg       top
bind pager G        bottom
bind pager J        next-entry
bind pager K        previous-entry
bind index,pager R  group-reply
bind index <tab>    sync-mailbox
bind index k        previous-entry
bind index j        next-entry
bind index gg       first-entry
bind index G        last-entry
bind index \Cp      recall-message
bind index <space>  collapse-thread

# force inbox sync
macro index si "<shell-escape>/usr/bin/offlineimap -q<enter>" "Sync Inbox"

# search via notmuch
macro index S "<enter-command>unset wait_key<enter><shell-escape>mutt-notmuch-py<enter><change-folder-readonly>~/.cache/mutt_results<enter>"
# }}}

# Appearance {{{
set markers=no
set pager_index_lines=15
set sort='threads'
set sort_aux='reverse-last-date-received'
set sort_re
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set uncollapse_jump

# colour scheme de jour
# source ~/.mutt/numix.muttrc
source ~/.mutt/vombatidae.mutt
# source ~/.mutt/sjl.muttrc
#source ~/.mutt/zenburn.muttrc
#source ~/.mutt/molokai.muttrc
#source ~/.mutt/kindly.muttrc
#source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-16.muttrc

# Colour messages differently when I'm GitHub-mentioned.
color index green color234 '~b "@noffle"'
# }}}

# URL handling {{{
macro pager \cu <pipe-entry>'url-menu'<enter> 'Follow links'
# }}}

# Addressbook {{{
source ~/.mutt/addressbook
# }}}
